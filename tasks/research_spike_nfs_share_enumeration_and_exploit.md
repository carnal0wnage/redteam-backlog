# üì¶ Research Spike: NFS Share Enumeration & Exploitation

**Goal:**  
Identify internal systems exposing misconfigured NFS (Network File System) shares that may allow unauthorized access, file extraction, or remote code execution via writable mounts or user ID spoofing.

**Why It Matters:**  
NFS is still widely used on internal Linux/Unix networks and is often misconfigured to allow dangerous levels of access (e.g., read/write shares, root squash disabled). Enumeration and exploitation of NFS teaches core lateral movement and file access tradecraft.

---

### üîç Scope
- Internal IPv4 ranges accessible from the red team lab or operator system
- Linux/Unix systems running NFS servers
- Targets using ports 2049/tcp (NFS), 111/tcp/udp (rpcbind)

---

### ‚úÖ Tasks
- [ ] Scan for NFS using Nmap:
  - `nmap -sV -p 111,2049 --script=nfs* <target-range>`
- [ ] Identify hosts running `rpcbind` or `nfsd` services
- [ ] Use the following tools to enumerate NFS exports:
  - `showmount -e <IP>`
  - `rpcinfo -p <IP>`
  - `nmap --script=nfs-ls,nfs-statfs -p 2049 <IP>`
- [ ] Attempt to mount the NFS export:
  - `mkdir /tmp/nfsmount`
  - `sudo mount -t nfs <IP>:/exported/path /tmp/nfsmount`
- [ ] Analyze the contents:
  - Look for config files, `.bash_history`, `.ssh/`, scripts, password files
- [ ] Check for write access:
  - Try creating or modifying files (if allowed)
  - Note whether root squash is enabled or disabled
- [ ] Clean up: unmount and remove mount directory after testing

---

### üéØ Deliverables
- Internal report or wiki entry with:
  - List of hosts running NFS + export paths
  - Mount access levels (read-only, read/write, root access)
  - Screenshot of enumeration and mount commands
  - Summary of interesting findings (config files, keys, creds)
  - Risk assessment and remediation guidance (e.g., restrict IPs, enforce root squash)

---

### üìö Reference Materials
- TryHackMe NFS module: https://tryhackme.com/room/nfs  
- HackTricks - NFS: https://book.hacktricks.xyz/network-services-pentesting/nfs  
- Linux NFS Guide: https://wiki.archlinux.org/title/NFS  
- Nmap NSE scripts: `nfs-ls`, `nfs-statfs`, `nfs-showmount`  
- SANS Pentest Poster (NFS section): https://www.sans.org/posters/

---

### üè∑Ô∏è Tags / Labels
`junior-friendly` `nfs` `internal-enum` `file-access` `misconfig` `unix`

---

### üìà Effort Level
**Small (S)** ‚Äî straightforward enumeration and mount tests with common tooling.

---

### ‚úÖ Acceptance Criteria
- [ ] At least 2 internal systems scanned for NFS
- [ ] At least one export successfully enumerated and mounted
- [ ] Access level tested (RO, RW, root squash)
- [ ] Any sensitive files noted and redacted
- [ ] Screenshots or logs included in report
- [ ] Writeup shared internally or on wiki with recommendations