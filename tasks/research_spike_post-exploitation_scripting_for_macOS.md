# üçé Research Spike: Post-Exploitation Scripting for Password File Discovery (macOS)

**Goal:**  
Script post-exploitation tooling in Zsh, Bash, or Python to search macOS systems for credential residue, insecure cloud config files, and user-exposed secrets common in dev or IT user environments.

**Why It Matters:**  
macOS endpoints often house sensitive business logic and app data (especially MDM-enrolled or exec laptops). Common targets include exported passwords, cached CLI tokens, and synced cloud folders.

---

### ‚úÖ Tasks

- [ ] Scan these key locations:
  - `~/Library/Preferences`, `~/Documents`, `~/Downloads`
  - `~/Library/Application Support/*` (Slack, Docker, Chrome)
  - `.aws`, `.gcloud`, `.azure`, `.npmrc`, `.git-credentials`
  - Apple Notes (via local SQLite), Terminal history files
- [ ] Use:
  - `find` + `grep -iE 'pass|secret|token|api_key'`
  - Python or Swift script for SQLite browsing (`Login Data`, Keychain)
- [ ] Output JSON or CSV with path + line matches
- [ ] Optionally detect synced apps (Dropbox, iCloud, Google Drive)

---

### üéØ Deliverables

- `osx_secret_finder.sh` or `mac_sniff.py`
- Matches: redacted previews + path
- Documented scan coverage map
- Notes on M1/M2 TCC sandbox bypass if applicable
- Recommendations:
  - Home directory targeting
  - Cloud app sync detection
  - `mdfind` or Spotlight-enhanced search extensions

---

### üìö References

- MITRE T1552  
- macOS post-ex guides (Objective-See, osquery)  
- Apple Cloud paths: `~/Library/Mobile Documents/`  
- Keychain CLI (`security` tool)  

---

### üè∑Ô∏è Tags

`macos-postex` `zsh` `python` `t1552` `icloud-leakage` `token-hunting` `cloud-creds` `exec-laptop`

---

### üìà Effort Level

**Medium (M)** ‚Äî needs access to test macOS host (ideally dev or exec profile).

---

### ‚úÖ Acceptance Criteria

- [ ] Script tested on Intel + ARM macOS systems  
- [ ] At least 3 demo or test secrets matched  
- [ ] Optional: Spotlight-based variant attempted  
- [ ] Output is clean + saved to local results file  
- [ ] Added to post-ex macOS wiki or shared folder