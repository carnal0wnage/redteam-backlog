# üìÑ Research Spike: Office Macro Malware

**Goal:**  
Create safe, non-malicious Office macro payloads that replicate real attacker behavior. Deliver them via test phishing documents and map the resulting behavior to MITRE ATT&CK techniques (e.g., T1204.002: Malicious File, T1059: Command and Scripting Interpreter). Log endpoint telemetry to understand what‚Äôs detected and what‚Äôs missed.

**Why It Matters:**  
Office macros are one of the most historically successful phishing delivery methods. Learning how they work, how to safely simulate them, and how to detect them gives junior red teamers foundational experience in emulating real adversaries and generating blue team telemetry.

---

### üîç Scope
- macOS and Windows systems with Office installed (lab or test VMs)
- Only benign payloads (e.g., message boxes, harmless callbacks)
- Tools: Microsoft Word/Excel, `msfvenom` (for simulation), `VBA`, EDR logs, MITRE ATT&CK

---

### ‚úÖ Tasks
- [ ] Choose at least 2 MITRE techniques to emulate:
  - T1204.002 ‚Äì Malicious File (Office)
  - T1059 ‚Äì Command & Scripting Interpreter (PowerShell, CMD)
  - T1566 ‚Äì Phishing
  - T1106 ‚Äì Native API
- [ ] Build at least 2 different macro payloads:
  - [ ] Payload 1: Display a message box or call out to webhook using `MSXML2.XMLHTTP`
  - [ ] Payload 2: Run a local PowerShell/AppleScript/Terminal command (harmless)
- [ ] Deliver each payload:
  - [ ] Open directly on test machine
  - [ ] Send via test phishing simulation (e.g., GoPhish or local email)
- [ ] Log behavior:
  - Check for Defender or EDR alerts
  - Note if macro warning or Trust Center blocks execution
  - Monitor process tree (e.g., `winword.exe ‚Üí powershell.exe`)
- [ ] Document any OPSEC considerations:
  - Default Office macro settings
  - Macro execution triggers (`AutoOpen`, `Document_Open`, form buttons)
  - File formats that bypass initial filters (`.docm`, `.xlsm`, zipped docs)

---

### üéØ Deliverables
- Safe macro PoC files (`.docm`, `.xlsm`, macro source code)
- MITRE technique map for each payload + explanation of how the macro aligns with behavior
- Screenshots of endpoint logs, AV/EDR alerts, and execution results
- Table of:
  - Payload name
  - Trigger method
  - Observed telemetry
  - Detected or blocked?
- Internal markdown or wiki page with:
  - Macro templates
  - Lab instructions
  - Detection tips for blue team

---

### üìö Reference Materials
- MITRE ATT&CK Techniques: https://attack.mitre.org/techniques/  
- T1204.002 (Malicious File): https://attack.mitre.org/techniques/T1204/002/  
- T1059 (Command and Scripting Interpreter): https://attack.mitre.org/techniques/T1059/  
- Red Canary Threat Reports: https://redcanary.com/threat-detection-report/  
- Elastic Detection Rule Pack: https://github.com/elastic/detection-rules  
- VBA Macro Reference: https://learn.microsoft.com/en-us/office/vba/api/overview/  
- `GoPhish` Phishing Framework: https://github.com/gophish/gophish  
- Safe macro examples: https://github.com/rvrsh3ll/MacroShop (use only benign ones)

---

### üè∑Ô∏è Tags / Labels
`junior-friendly` `office-macros` `mitre-mapping` `vba` `payloads` `phishing` `windows`

---

### üìà Effort Level
**Medium (M)** ‚Äî requires VBA scripting, macro debugging, and telemetry capture.

---

### ‚úÖ Acceptance Criteria
- [ ] At least 2 macro payloads built and tested
- [ ] Behavior mapped to 2+ MITRE techniques
- [ ] Documented process tree or detection for each macro
- [ ] Screenshots/logs of alerts or behavior collected
- [ ] Internal writeup created with macro code, MITRE mapping, and detection suggestions