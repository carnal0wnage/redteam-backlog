# üíæ Research Spike: Post-Exploitation Scripting for Password File Discovery (Windows)

**Goal:**  
Build lightweight PowerShell (or equivalent) scripts to search compromised Windows systems for files likely to contain passwords, credentials, or sensitive secrets ‚Äî including browser exports, config files, cloud CLI caches, and developer leftovers.

**Why It Matters:**  
After initial access, speed and stealth are critical. Having modular post-exploitation tools that auto-identify sensitive files saves time, increases signal, and helps junior red teamers develop situational awareness and scripting fluency.

---

### üîç Scope

**Target File Types:**
- Plaintext credentials in `.txt`, `.csv`, `.log`, `.md`, `.docx`
- KeePass, LastPass, 1Password export formats
- RDP and VPN configs (`.rdp`, `.pbk`, `.ovpn`)
- Browser export files (`Login Data`, `Passwords.csv`)
- App secrets in:
  - `.env`, `settings.json`, `.ini`, `.ps1`, `.bat`
- Developer residue:
  - `.git-credentials`, `.npmrc`, `AzureProfile.json`
- Cloud credentials:
  - `%USERPROFILE%\.aws\credentials`
  - `%USERPROFILE%\.azure\accessTokens.json`
  - `%APPDATA%\Microsoft\Credentials\`

---

### ‚úÖ Tasks

- [ ] Build a PowerShell script with:
  - Targeted file extension search (`Get-ChildItem -Recurse`)
  - Grep-like keyword match (`Select-String -Pattern`)
  - Size limits to avoid binaries
  - Optional entropy scoring for secrets
- [ ] Add logging and safety flags (e.g., dry run, exfil paths)
- [ ] Optimize for speed + stealth (limit paths, avoid AV triggers)
- [ ] Optional: Compile into obfuscated `.exe` for use in payloads
- [ ] Test against Windows testbox (user and admin contexts)
- [ ] Output:
  - Matched files + excerpt
  - Timestamps
  - User context (who created/owns file)

---

### üéØ Deliverables

- PowerShell or batch script: `Find-Secrets.ps1`
- Example findings: screenshots, redacted excerpts
- Documentation:
  - Parameters and usage examples
  - False positive avoidance tips
- Recommendations:
  - Log file cleanup
  - Target user profile dirs, dev folders, cloud CLIs
  - Use per-engagement customization (e.g., add customer-specific toolnames)

---

### üìö Reference Materials

- PowerShell File Search:  
  `Get-ChildItem -Path C:\Users -Include *.txt,*.csv -Recurse -ErrorAction SilentlyContinue`
- Secret Entropy Check (sample): https://github.com/trufflesecurity/trufflehog  
- Windows Cloud CLI paths:  
  - AWS: `%USERPROFILE%\.aws\credentials`  
  - Azure: `%USERPROFILE%\.azure\accessTokens.json`  
- SANS 504 Post-Ex Guide  
- MITRE T1552 (Unsecured Credentials): https://attack.mitre.org/techniques/T1552/

---

### üè∑Ô∏è Tags / Labels

`windows-postex` `powershell` `t1552` `passwords` `secrets` `post-compromise` `automation` `junior-friendly` `cloud-creds` `cli-leaks`

---

### üìà Effort Level

**Medium (M)** ‚Äî beginner scripting skills needed; can be modularized into reusable red team tools.

---

### ‚úÖ Acceptance Criteria

- [ ] Script tested on Windows VM or lab host  
- [ ] At least 5 file types/paths covered  
- [ ] Matches include at least one fake or realistic test credential  
- [ ] Usage instructions and example output included  
- [ ] Delivered script added to post-ex toolkit repo or shared folder